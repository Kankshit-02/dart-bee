<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dart Game Score Manager - Track your dart games with detailed statistics">
    <meta name="theme-color" content="#7d5f92">

    <title>Dart Bee - Game Score Manager</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles/main.css?v=20260108.1946">
    <link rel="stylesheet" href="styles/components.css?v=20260108.1946">

    <!-- Cache Control -->
    <meta http-equiv=20260108.1505"Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv=20260108.1505"Pragma" content="no-cache">
    <meta http-equiv=20260108.1505"Expires" content="0">

    <!-- Manifest for PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üêù</text></svg>">

    <!-- Supabase & Configuration -->
    <!-- Load Supabase Client Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Chart.js for data visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <!-- Load Configuration (contains API credentials) -->
    <script src="scripts/config.js?v=20260108.1946"></script>
</head>
<body>
    <div id="app" class="app-container">
        <!-- Navigation Bar -->
        <nav class="navbar">
            <div class="navbar-brand">
                <span class="bee-icon">üêù</span>
                <span class="app-title">Dart Bee</span>
            </div>
            <div class="navbar-nav">
                <button class="nav-link active" data-page="home" aria-label="Home">
                    <span class="icon">üè†</span>
                    <span class="label">Home</span>
                </button>
                <button class="nav-link" data-page="new-game" aria-label="New Game">
                    <span class="icon">‚ûï</span>
                    <span class="label">New Game</span>
                </button>
                <button class="nav-link" data-page="history" aria-label="History">
                    <span class="icon">üìã</span>
                    <span class="label">History</span>
                </button>
                <button class="nav-link" data-page="leaderboard" aria-label="Leaderboard">
                    <span class="icon">üèÜ</span>
                    <span class="label">Leaderboard</span>
                </button>
                <button class="nav-link" data-page="stats" aria-label="Stats">
                    <span class="icon">üìä</span>
                    <span class="label">Stats</span>
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Home Page -->
            <div id="home-page" class="page active">
                <div class="page-header">
                    <h1>Welcome to Dart Bee</h1>
                    <p>Track your dart games and dominate the leaderboard</p>
                </div>

                <div class="home-grid-2col">
                    <!-- Left Column: Stats & Actions -->
                    <div class="home-left-column">
                        <!-- Stats Widget Section with Quick Action -->
                        <section class="home-section">
                            <div class="stats-widget-header">
                                <h3 style="margin: 0; color: var(--color-primary);">Quick Stats</h3>
                                <button class="btn btn-primary btn-small" id="quick-new-game" style="white-space: nowrap;">
                                    <span class="icon">‚ûï</span>
                                    New Game
                                </button>
                            </div>
                            <div class="stats-widget">
                                <div class="stats-grid">
                                    <div class="stat-card">
                                        <div class="stat-icon">üéÆ</div>
                                        <div class="stat-content">
                                            <div class="stat-value" id="stat-games">0</div>
                                            <div class="stat-label">Games Played</div>
                                        </div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-icon">üë•</div>
                                        <div class="stat-content">
                                            <div class="stat-value" id="stat-players">0</div>
                                            <div class="stat-label">Players</div>
                                        </div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-icon">‚≠ê</div>
                                        <div class="stat-content">
                                            <div class="stat-value" id="stat-top-player">‚Äî</div>
                                            <div class="stat-label">Top Player</div>
                                        </div>
                                    </div>
                                    <div class="stat-card">
                                        <div class="stat-icon">üìä</div>
                                        <div class="stat-content">
                                            <div class="stat-value" id="stat-avg">0</div>
                                            <div class="stat-label">Best Avg/Dart</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>

                    <!-- Right Column: Recent Games -->
                    <section class="home-section recent-games-column">
                        <h2>Recent Games</h2>
                        <div id="recent-games-list" class="games-list">
                            <p class="placeholder">No games yet. Start your first game!</p>
                        </div>
                    </section>
                </div>
            </div>

            <!-- New Game Page -->
            <div id="new-game-page" class="page">
                <div class="page-header">
                    <h1>Create New Game</h1>
                </div>

                <form id="new-game-form" class="form-container">
                    <!-- Number of Players -->
                    <div class="form-group">
                        <label for="player-count">Number of Players</label>
                        <div class="form-control">
                            <button type="button" class="stepper-btn" id="decrease-players">‚àí</button>
                            <input type="number" id="player-count" name="playerCount" min="1" max="8" value="2" readonly>
                            <button type="button" class="stepper-btn" id="increase-players">+</button>
                        </div>
                    </div>

                    <!-- Player Names -->
                    <div class="form-group">
                        <label>Player Names (Optional)</label>
                        <div id="player-names-container" class="player-names-grid">
                            <!-- Dynamically generated -->
                        </div>
                    </div>

                    <!-- Game Type -->
                    <div class="form-group">
                        <label for="game-type">Starting Points</label>
                        <select id="game-type" name="gameType">
                            <option value="101">101</option>
                            <option value="201">201</option>
                            <option value="301">301</option>
                            <option value="501" selected>501 (Standard)</option>
                            <option value="701">701</option>
                            <option value="1001">1001</option>
                            <option value="custom">Custom</option>
                        </select>
                        <input type="number" id="custom-points" name="customPoints" min="1" max="9999" placeholder="Enter custom points" class="hidden">
                    </div>

                    <!-- Win Condition -->
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="win-below" name="winBelow">
                            <span>Win at zero or below (instead of exact zero)</span>
                        </label>
                    </div>

                    <!-- Scoring Mode -->
                    <div class="form-group">
                        <label>Scoring Mode</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="scoringMode" value="per-dart" checked>
                                <span>Per Dart (Enter 3 darts per turn - recommended for stats)</span>
                            </label>
                            <label>
                                <input type="radio" name="scoringMode" value="per-turn">
                                <span>Per Turn Total (Enter total of all 3 darts)</span>
                            </label>
                        </div>
                    </div>

                    <!-- Submit -->
                    <button type="submit" class="btn btn-primary btn-large">Start Playing</button>
                </form>
            </div>

            <!-- Active Game Page -->
            <div id="active-game-page" class="page">
                <div class="page-header">
                    <h1 id="game-title">Game</h1>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <button class="btn btn-success btn-small" id="share-game-btn">üì§ Share Game</button>
                        <button class="btn btn-secondary btn-small" id="end-game-btn">End Game</button>
                    </div>
                </div>

                <!-- Score Board -->
                <div id="scoreboard" class="scoreboard">
                    <!-- Dynamically generated player scores -->
                </div>

                <!-- Game Content Wrapper (2-column layout: Dart Entry + Live Rankings) -->
                <div class="game-content-wrapper">
                    <!-- Dart Entry Section -->
                    <div class="dart-entry-section">
                        <h2 id="current-player-name">Player 1</h2>

                        <div id="dart-inputs-container" class="dart-inputs">
                            <!-- Dynamically generated dart inputs -->
                        </div>

                        <div class="dart-actions">
                            <button type="button" class="btn btn-secondary" id="undo-dart-btn">‚Ü∂ Undo Dart</button>
                            <button type="button" class="btn btn-primary" id="submit-turn-btn">Submit Turn</button>
                        </div>
                    </div>

                    <!-- Live Rankings Board (Side by side) -->
                    <div id="live-rankings" class="live-rankings">
                        <div class="rankings-title">üìä Live Rankings</div>
                        <div id="rankings-list" class="rankings-list">
                            <!-- Dynamically generated -->
                        </div>
                    </div>
                </div>

                <!-- Turn History Section (Full width at bottom) -->
                <div class="turn-history-section">
                    <h3>Turn History</h3>
                    <div id="turn-history" class="turn-history-list">
                        <!-- Dynamically generated history -->
                    </div>
                </div>

                <!-- Game Completion Modal -->
                <div id="game-completion-modal" class="modal hidden">
                    <div class="modal-content game-completion-content">
                        <div class="completion-header">
                            <h2>üèÜ Game Complete!</h2>
                        </div>
                        <div id="completion-rankings" class="completion-rankings">
                            <!-- Final rankings will be inserted here -->
                        </div>
                        <div class="completion-actions">
                            <button class="btn btn-primary btn-large" id="rematch-btn">
                                <span class="icon">üîÑ</span>
                                Rematch with Same Players
                            </button>
                            <button class="btn btn-secondary btn-large" id="home-btn">
                                <span class="icon">üè†</span>
                                Go to Home
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Game History Page -->
            <div id="history-page" class="page">
                <div class="page-header">
                    <h1>Game History</h1>
                    <p id="history-games-count" style="font-size: 14px; color: var(--color-text-light);">Loading...</p>
                </div>

                <!-- Filters -->
                <div class="filter-section">
                    <input type="text" id="history-player-filter" placeholder="Filter by player..." class="form-input">
                    <select id="history-sort" class="form-input">
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                    </select>
                </div>

                <!-- Games List -->
                <div id="games-history-list" class="games-list">
                    <p class="placeholder">No games yet</p>
                </div>

                <!-- Pagination Controls -->
                <div id="pagination-controls" class="pagination-controls" style="display: none;">
                    <div class="pagination-info">
                        <span id="pagination-info-text">Page 1 of 1</span>
                    </div>
                    <div class="pagination-buttons">
                        <button id="pagination-prev" class="btn btn-secondary btn-small" disabled>‚Üê Previous</button>
                        <div id="pagination-numbers" class="pagination-numbers"></div>
                        <button id="pagination-next" class="btn btn-secondary btn-small" disabled>Next ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Game Detail Page -->
            <div id="game-detail-page" class="page hidden">
                <div class="page-header">
                    <button class="btn btn-secondary btn-small" id="back-to-history">‚Üê Back</button>
                    <h1 id="detail-game-title">Game Details</h1>
                </div>

                <div id="game-detail-content" class="detail-content">
                    <!-- Dynamically generated -->
                </div>
            </div>

            <!-- Leaderboard Page -->
            <div id="leaderboard-page" class="page">
                <div class="page-header">
                    <h1>Leaderboard</h1>
                </div>

                <!-- Time Filter -->
                <div class="filter-section">
                    <div class="time-filters">
                        <button class="filter-btn active" data-filter="all-time">All Time</button>
                        <button class="filter-btn" data-filter="30-days">Last 30 Days</button>
                        <button class="filter-btn" data-filter="7-days">Last 7 Days</button>
                    </div>
                </div>

                <!-- Leaderboard Tabs -->
                <div class="leaderboard-tabs">
                    <button class="tab-btn active" data-tab="wins">Most Wins</button>
                    <button class="tab-btn" data-tab="win-rate">Best Win Rate</button>
                    <button class="tab-btn" data-tab="avg-dart">Avg Per Turn</button>
                    <button class="tab-btn" data-tab="max-turn">Top Turn</button>
                </div>

                <!-- Rankings -->
                <div id="leaderboard-content" class="leaderboard-list">
                    <p class="placeholder">No games yet</p>
                </div>
            </div>

            <!-- Global Stats Page -->
            <div id="stats-page" class="page">
                <div class="page-header">
                    <h1>Global Statistics</h1>
                    <button class="btn btn-secondary btn-small" id="stats-settings-btn" onclick="StatsWidgets.openSettings()">
                        ‚öôÔ∏è Customize
                    </button>
                </div>

                <!-- Player Selector for detailed stats -->
                <div class="stats-player-selector">
                    <label for="stats-player-select">View stats for:</label>
                    <select id="stats-player-select" class="form-input">
                        <option value="">-- Select Player --</option>
                    </select>
                    <button class="btn btn-secondary btn-small" id="compare-players-btn">Compare Players</button>
                </div>

                <!-- Global Stats Summary -->
                <div id="global-stats-summary" class="global-stats-summary">
                    <!-- Dynamically generated -->
                </div>

                <!-- Player-specific widgets (when player selected) -->
                <div id="player-stats-widgets" class="player-stats-widgets">
                    <!-- Dynamically generated -->
                </div>

                <!-- Player Comparison Modal -->
                <div id="comparison-modal" class="comparison-modal hidden">
                    <div class="comparison-modal-content">
                        <button class="modal-close" onclick="UI.closeComparisonModal()">√ó</button>
                        <h2>Compare Players</h2>
                        <div class="comparison-selectors">
                            <select id="compare-player-1" class="form-input">
                                <option value="">Select Player 1</option>
                            </select>
                            <span class="vs-text">VS</span>
                            <select id="compare-player-2" class="form-input">
                                <option value="">Select Player 2</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" id="run-comparison-btn">Compare</button>
                        <div id="comparison-result" class="comparison-result">
                            <!-- Dynamically generated -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Player Profile Page -->
            <div id="player-profile-page" class="page hidden">
                <div class="page-header">
                    <button class="btn btn-secondary btn-small" id="back-to-leaderboard">‚Üê Back</button>
                    <h1 id="profile-player-name">Player Profile</h1>
                </div>

                <div id="player-profile-content" class="profile-content">
                    <!-- Dynamically generated -->
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Loader -->
    <div id="loader" class="loader hidden">
        <div class="loader-spinner"></div>
        <p class="loader-text">Loading...</p>
    </div>

    <!-- Modal Dialog -->
    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">&times;</button>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- Scripts (load in specific order) -->
    <!-- 1. Device manager (must load first) -->
    <script src="scripts/device.js?v=20260108.1946"></script>
    <!-- 2. Supabase client initialization (must load before storage) -->
    <script src="scripts/supabase-client.js?v=20260108.1946"></script>
    <!-- 3. Storage layer (uses Supabase) -->
    <script src="scripts/storage.js?v=20260108.1946"></script>
    <!-- 4. Game logic -->
    <script src="scripts/game.js?v=20260108.1946"></script>
    <!-- 5. Statistics -->
    <script src="scripts/stats.js?v=20260108.1946"></script>
    <!-- 6. Charts module -->
    <script src="scripts/charts.js?v=20260108.1946"></script>
    <!-- 7. Stats Widgets module -->
    <script src="scripts/statsWidgets.js?v=20260108.1946"></script>
    <!-- 8. Router for URL-based navigation -->
    <script src="scripts/router.js?v=20260108.1946"></script>
    <!-- 9. UI rendering -->
    <script src="scripts/ui.js?v=20260108.1946"></script>
    <!-- 10. Main app logic -->
    <script src="scripts/app.js?v=20260108.1946"></script>
</body>
</html>
